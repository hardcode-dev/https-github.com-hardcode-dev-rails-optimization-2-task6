# Попрактиковаться в оптимизации загрузки js

### Что было сделано?

1. Установил бюджет, которого требуется достичь.
2. Убедился, что метрика собирается.
3. Выстроил feedback loop.
4. Начал оптимизацию.

### Установка бюджета

Установил бюджет для sitespeed.io, убедился, что он не проходит (т.к. оптимизация не была выполнена).

### Оптимизация

1. Воспользовался `webpack-bundle-analyzer`, чтобы проанализировать bundle.
2. Увидел, что постоянно грузится `chart.js`, начал искать где он отображается.
3. Стало понятно, что отображаются графики для **pro** пользователей (`@user.has_role? :pro`).
4. Сделал вывод, что не нужно его тащить постоянно, воспользовался `react-loadable` для асинхронной загрузки.
5. Выполнил тест с помощью sitespeed.io, бюджет выполнен.

### Feedback loop

1. Убедился, что сборка js работает.
2. Убедился, что нет ошибок по google dev console.
3. Убедился, что графики не отображаются для **обычных** пользователей.
4. Убедился, что графики отображаются для **pro** пользователей
