# Case-study оптимизации

# Проблема

Необходимо уменьшить размер загружамого JS до, как минимум, 449.2 KB

### Шаг №1

При запуске с указанным бюджетом выходила ошибка
`Failing budget JavaScript Transfer Size for https://192.168.0.107/ with value 3.2 MB max limit 449.2 KB`

Когда закомментировал proCharts.js то вес значительно уменьшился (ожидаемо), но мы и в бюджет не входили, да и часть функционала просто закомментировали.

Проанализировав проект, мы видим, что вызывается хелпер `javascript_pack_tag «имя_пакета»` - и вызывается он только в тех местах, где действительно нужен.

Например, сам `proCharts.js` вызывался в `dashboards/pro.html`, но при этом, сам `proCharts.js` и его зависимости присутствовали в одном общем бандле `vendor.js`

Есть понимание, что необходимо эту часть «отделить». Прогуглив и почитав документацию webpack, обнаружил, что можно этого добиться указав исключающие пакеты в конфиге плагина `CommonsChunkVendor` — ныне он deprecated (в Webpack 4)

Путем просмотра того, что выдает `webpack-bundle-analyzer`, был определен список пакетов, необходимых для отделения в отдельные чанки

В итоге, результат до
![before](https://i.ibb.co/KWmxPZ5/before.jpg)

И после

![before](https://i.ibb.co/Q844Y0t/after.jpg)

Иными словами, удалось уложиться в бюджет, и уменьшил размер до 424.8 KB

### Шаг 2

Настроил github actions CI

![ci](https://ibb.co/h8XMz1b)

## Результаты

Научился разбивать на чанки JS, а также все это дело анализировать
